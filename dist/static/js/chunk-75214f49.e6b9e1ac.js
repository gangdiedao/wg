(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-75214f49"],{"09f4":function(e,t,a){"use strict";a.d(t,"a",(function(){return o})),Math.easeInOutQuad=function(e,t,a,n){return e/=n/2,e<1?a/2*e*e+t:(e--,-a/2*(e*(e-2)-1)+t)};var n=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(e){window.setTimeout(e,1e3/60)}}();function i(e){document.documentElement.scrollTop=e,document.body.parentNode.scrollTop=e,document.body.scrollTop=e}function l(){return document.documentElement.scrollTop||document.body.parentNode.scrollTop||document.body.scrollTop}function o(e,t,a){var o=l(),r=e-o,s=20,d=0;t="undefined"===typeof t?500:t;var u=function e(){d+=s;var l=Math.easeInOutQuad(d,o,r,t);i(l),d<t?n(e):a&&"function"===typeof a&&a()};u()}},4173:function(e,t,a){},4452:function(e,t,a){"use strict";var n=a("4173"),i=a.n(n);i.a},4751:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-container",[a("el-aside",{staticClass:"user-aside"},[a("div",[a("label",{on:{click:e.clearDept}},[e._v("组织架构")])]),e._v(" "),a("el-tree",{attrs:{data:e.deptList,"node-key":"id","expand-on-click-node":!1,"default-expand-all":"",props:e.defaultProps,draggable:!1,"allow-drop":e.allowDrop,"allow-drag":e.allowDrag},on:{"node-drag-start":e.handleDragStart,"node-drag-enter":e.handleDragEnter,"node-drag-leave":e.handleDragLeave,"node-drag-over":e.handleDragOver,"node-drag-end":e.handleDragEnd,"node-drop":e.handleDrop,"node-click":e.handleClickNode}})],1),e._v(" "),a("el-main",[a("label",[e._v(e._s(e.deptName)+"用户列表")]),e._v(" "),a("el-row",{staticClass:"row-bg",attrs:{type:"flex",justify:"space-between"}},[a("el-col",{attrs:{span:12}},[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.handleAdd}},[e._v(e._s(e.$t("actions.create")))]),e._v(" "),a("el-button",{attrs:{type:"success",disabled:!e.multipleSelection.length,size:"mini"},on:{click:function(t){return e.handleChangeStatus(1)}}},[e._v(e._s(e.$t("actions.open")))]),e._v(" "),a("el-button",{attrs:{size:"mini",disabled:!e.multipleSelection.length},on:{click:function(t){return e.handleChangeStatus(2)}}},[e._v(e._s(e.$t("actions.close")))]),e._v(" "),a("el-button",{attrs:{size:"mini",disabled:!e.multipleSelection.length},on:{click:e.handleTransfers}},[e._v(e._s(e.$t("actions.transfer")))])],1),e._v(" "),a("el-col",{staticStyle:{"text-align":"right"},attrs:{span:12}},[a("el-input",{staticClass:"input-with-select",attrs:{placeholder:e.$t("organization.userModules.field.username"),size:"mini"},model:{value:e.listQuery.keyword,callback:function(t){e.$set(e.listQuery,"keyword",t)},expression:"listQuery.keyword"}},[a("el-button",{attrs:{slot:"append",type:"primary",icon:"el-icon-search"},on:{click:e.handleSearch},slot:"append"},[e._v(e._s(e.$t("actions.search")))])],1)],1)],1),e._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData,border:""},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",align:"center",width:"55"}}),e._v(" "),a("el-table-column",{attrs:{prop:"username",label:e.$t("organization.userModules.field.username"),fixed:"left",width:"120"}}),e._v(" "),a("el-table-column",{attrs:{prop:"name",label:e.$t("organization.userModules.field.name"),fixed:"left",width:"120"}}),e._v(" "),a("el-table-column",{attrs:{prop:"name_en",label:e.$t("organization.userModules.field.nameEn"),width:"120"}}),e._v(" "),a("el-table-column",{attrs:{label:e.$t("organization.userModules.field.nationality"),width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.nationality&&t.row.nationality.name))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:e.$t("organization.userModules.field.deptname"),width:"160"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.department&&t.row.department.name))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:e.$t("organization.userModules.field.role"),width:"160"},scopedSlots:e._u([{key:"default",fn:function(t){return e._l(t.row.roles,(function(t){return a("el-tag",{key:t.id,attrs:{type:"info"}},[e._v(e._s(t.name))])}))}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"phone",label:e.$t("organization.userModules.field.phone"),width:"120"}}),e._v(" "),a("el-table-column",{attrs:{prop:"remark",label:e.$t("organization.userModules.field.remark")}}),e._v(" "),a("el-table-column",{attrs:{prop:"status",label:e.$t("organization.userModules.field.status"),width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tag",{attrs:{type:1===t.row.status?"success":"info"}},[e._v(e._s(1===t.row.status?e.$t("actions.open"):e.$t("actions.close")))])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"created_at",label:e.$t("organization.userModules.field.createTime"),width:"160"}}),e._v(" "),a("el-table-column",{attrs:{fixed:"right",width:"100",label:e.$t("organization.userModules.field.action")},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){return e.handleTransfer(t.row)}}},[e._v(e._s(e.$t("actions.transfer")))]),e._v(" "),a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){return e.handleEdit(t.row)}}},[e._v(e._s(e.$t("actions.edit")))])]}}])})],1),e._v(" "),a("el-row",{attrs:{type:"flex",justify:"end"}},[a("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total>0"}],attrs:{total:e.total,page:e.listQuery.page,limit:e.listQuery.limit},on:{"update:page":function(t){return e.$set(e.listQuery,"page",t)},"update:limit":function(t){return e.$set(e.listQuery,"limit",t)},pagination:e.getList}})],1)],1),e._v(" "),a("user-edit",{attrs:{show:e.showUserEdit,item:e.userItem,"dept-id":e.listQuery.department_id,"dept-name":e.deptName},on:{"update:show":function(t){e.showUserEdit=t},success:e.getList}}),e._v(" "),a("transfer",{attrs:{show:e.showTransfer,ids:e.userIds},on:{"update:show":function(t){e.showTransfer=t},success:e.getList}})],1)},i=[],l=(a("7f7f"),a("db72")),o=a("333d"),r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{title:e.textMap[e.dialogStatus],visible:e.dialogFormVisible,width:"720px",center:""},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[a("el-form",{ref:"ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:e.$t("organization.userModules.field.username"),prop:"username"}},[a("el-input",{model:{value:e.ruleForm.username,callback:function(t){e.$set(e.ruleForm,"username",t)},expression:"ruleForm.username"}})],1),e._v(" "),a("el-form-item",{attrs:{label:e.$t("organization.userModules.field.name"),prop:"name"}},[a("el-input",{model:{value:e.ruleForm.name,callback:function(t){e.$set(e.ruleForm,"name",t)},expression:"ruleForm.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:e.$t("organization.userModules.field.nameEn"),prop:"name_en"}},[a("el-input",{model:{value:e.ruleForm.name_en,callback:function(t){e.$set(e.ruleForm,"name_en",t)},expression:"ruleForm.name_en"}})],1),e._v(" "),a("el-form-item",{attrs:{label:e.$t("organization.userModules.field.password"),prop:"create"==e.dialogStatus?"password":""}},[a("el-input",{attrs:{type:"password"},model:{value:e.ruleForm.password,callback:function(t){e.$set(e.ruleForm,"password",t)},expression:"ruleForm.password"}})],1),e._v(" "),a("el-form-item",{attrs:{label:e.$t("organization.userModules.field.email"),prop:"email"}},[a("el-input",{model:{value:e.ruleForm.email,callback:function(t){e.$set(e.ruleForm,"email",t)},expression:"ruleForm.email"}})],1),e._v(" "),a("el-form-item",{attrs:{label:e.$t("organization.userModules.field.phone")}},[a("el-input",{attrs:{type:"number"},model:{value:e.ruleForm.phone,callback:function(t){e.$set(e.ruleForm,"phone",t)},expression:"ruleForm.phone"}})],1),e._v(" "),a("el-form-item",{attrs:{label:e.$t("organization.userModules.field.deptname")}},[a("el-popover",{attrs:{placement:"bottom",width:"550"},model:{value:e.open,callback:function(t){e.open=t},expression:"open"}},[a("div",{staticClass:"parent-node-body"},[a("el-input",{attrs:{placeholder:"输入关键字进行过滤"},model:{value:e.filterText,callback:function(t){e.filterText=t},expression:"filterText"}}),e._v(" "),a("el-tree",{ref:"tree",staticClass:"filter-tree",attrs:{data:e.deptList,props:e.defaultProps,"default-expand-all":"","highlight-current":!0,"expand-on-click-node":!1,"filter-node-method":e.filterNode},on:{"node-click":e.handleClickNode}})],1),e._v(" "),a("el-input",{attrs:{slot:"reference",readonly:""},slot:"reference",model:{value:e.parentname,callback:function(t){e.parentname=t},expression:"parentname"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:e.$t("organization.userModules.field.role")}},[a("el-select",{staticStyle:{width:"100%"},attrs:{multiple:"",filterable:"",placeholder:"请选择角色"},model:{value:e.ruleForm.role_id,callback:function(t){e.$set(e.ruleForm,"role_id",t)},expression:"ruleForm.role_id"}},[a("el-option",{attrs:{label:"区域一",value:"shanghai"}}),e._v(" "),a("el-option",{attrs:{label:"区域二",value:"beijing"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:e.$t("organization.userModules.field.remark")}},[a("el-input",{attrs:{type:"textarea"},model:{value:e.ruleForm.remark,callback:function(t){e.$set(e.ruleForm,"remark",t)},expression:"ruleForm.remark"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("\n      "+e._s(e.$t("actions.cancel"))+"\n    ")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){"create"===e.dialogStatus?e.createData():e.updateData()}}},[e._v("\n      "+e._s(e.$t("actions.confirm"))+"\n    ")])],1)],1)},s=[],d=(a("c5f6"),a("7a9c")),u=a("2f62"),c=a("d368"),m={mixins:[d["a"]],props:{show:{type:Boolean,default:!1},item:"",deptId:Number,deptName:String},watch:{filterText:function(e){this.$refs.tree.filter(e)},dialogFormVisible:function(e){e||(this.open=!1,this.$emit("update:show",!1))},show:function(e){this.dialogFormVisible=e,e&&(this.item?(this.ruleForm=this.assign(this.ruleForm,this.item),this.ruleForm.password=void 0,this.parentname=this.item.department.name,this.dialogStatus="update"):(this.parentname="",this.ruleForm={id:void 0,name:"",name_en:"",username:"",email:"",phone:"",nationality_id:void 0,department_id:void 0,role_id:[],password:"",remark:""},this.dialogStatus="create",this.deptId&&(this.ruleForm.department_id=this.deptId,this.parentname=this.deptName)))}},data:function(){return{open:!1,parentname:"",filterText:"",dialogFormVisible:this.show,dialogStatus:this.item?"update":"create",textMap:{update:"".concat(this.$t("actions.edit")," ").concat(this.$t("organization.userModules.field.user")),create:"".concat(this.$t("actions.create")," ").concat(this.$t("organization.userModules.field.user"))},defaultProps:{children:"childs",label:"name"},ruleForm:{id:void 0,name:"",name_en:"",username:"",email:"",phone:"",nationality_id:void 0,department_id:void 0,role_id:[],remark:""},rules:{name:[{required:!0,message:"请输入姓名",trigger:"blur"}],username:[{required:!0,message:"请输入用户名",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}],email:[{type:"email",message:"请选正确的emial",trigger:"blur"}]}}},computed:Object(l["a"])({},Object(u["b"])(["deptList"])),methods:{handleClickNode:function(e){this.ruleForm.department_id=e.id,this.parentname=e.name,this.open=!1},filterNode:function(e,t){return!e||-1!==t.name.indexOf(e)},close:function(){this.dialogFormVisible=!1},createData:function(){var e=this;Object(c["b"])(this.ruleForm).then((function(){e.$message({message:"创建用户成功",type:"success"}),e.$emit("success"),e.close()}))},updateData:function(){var e=this;Object(c["i"])(this.ruleForm).then((function(){e.$message({message:"修改用户成功",type:"success"}),e.$emit("success"),e.close()}))}}},p=m,f=a("2877"),h=Object(f["a"])(p,r,s,!1,null,null,null),g=h.exports,b=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{title:e.$t("organization.userModules.label.department")+e.$t("organization.userModules.label.transfer"),visible:e.dialogFormVisible,width:"480px",center:""},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[a("el-form",{attrs:{"label-width":"100px"}},[a("el-form-item",{attrs:{label:e.$t("organization.userModules.label.select")+e.$t("organization.userModules.label.department")}},[a("el-popover",{attrs:{placement:"bottom",width:"550"},model:{value:e.open,callback:function(t){e.open=t},expression:"open"}},[a("div",{staticClass:"parent-node-body"},[a("el-input",{attrs:{placeholder:"输入关键字进行过滤"},model:{value:e.filterText,callback:function(t){e.filterText=t},expression:"filterText"}}),e._v(" "),a("el-tree",{ref:"tree",staticClass:"filter-tree",attrs:{data:e.deptList,props:e.defaultProps,"default-expand-all":"","highlight-current":!0,"expand-on-click-node":!1,"filter-node-method":e.filterNode},on:{"node-click":e.handleClickNode}})],1),e._v(" "),a("el-input",{attrs:{slot:"reference",readonly:""},slot:"reference",model:{value:e.parentname,callback:function(t){e.parentname=t},expression:"parentname"}})],1)],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("\n      "+e._s(e.$t("actions.cancel"))+"\n    ")]),e._v(" "),a("el-button",{attrs:{type:"primary",disabled:!e.department_id},on:{click:e.submit}},[e._v("\n      "+e._s(e.$t("actions.confirm"))+"\n    ")])],1)],1)},v=[],_={props:{show:{type:Boolean,default:!1},ids:[String,Array]},watch:{filterText:function(e){this.$refs.tree.filter(e)},dialogFormVisible:function(e){e||this.$emit("update:show",!1)},show:function(e){this.parentname="",this.department_id="",this.dialogFormVisible=e}},computed:Object(l["a"])({},Object(u["b"])(["deptList"])),data:function(){return{defaultProps:{children:"childs",label:"name"},open:!1,parentname:"",filterText:"",dialogFormVisible:!1,department_id:""}},methods:{handleClickNode:function(e){this.department_id=e.id,this.parentname=e.name,this.open=!1},filterNode:function(e,t){return!e||-1!==t.name.indexOf(e)},submit:function(){var e=this;Object(c["f"])({id:this.ids,department_id:this.department_id}).then((function(){e.$message({message:"转移成功",type:"success"}),e.$emit("success"),e.dialogFormVisible=!1}))}}},w=_,y=Object(f["a"])(w,b,v,!1,null,null,null),$=y.exports,k={mixins:[d["a"]],name:"userManage",components:{Pagination:o["a"],UserEdit:g,Transfer:$},created:function(){this.deptList.length||this.$store.dispatch("organization/getDeptList",{page:1,limit:500}),this.getList()},computed:Object(l["a"])({},Object(u["b"])(["deptList"])),data:function(){return{deptName:"全部",defaultProps:{children:"childs",label:"name"},userItem:"",showUserEdit:!1,showTransfer:!1,userIds:"",total:0,listQuery:{page:1,limit:20,keyword:void 0,department_id:void 0},multipleSelection:[],tableData:[]}},methods:{handleAdd:function(){this.userItem="",this.showUserEdit=!0},handleEdit:function(e){this.userItem=e,this.showUserEdit=!0},handleTransfers:function(){this.userIds=this.multipleSelection.map((function(e){return e.id})),this.showTransfer=!0},handleTransfer:function(e){this.userIds=[e.id],this.showTransfer=!0},handleDelete:function(e,t){var a=this;this.$confirm("确定要删除该数据?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){a.$message({type:"success",message:"删除成功!"})})).catch((function(){}))},handleSelectionChange:function(e){this.multipleSelection=e},handleDragStart:function(e,t){console.log("drag start",e)},handleDragEnter:function(e,t,a){console.log("tree drag enter: ",t.label)},handleDragLeave:function(e,t,a){console.log("tree drag leave: ",t.label)},handleDragOver:function(e,t,a){console.log("tree drag over: ",t.label)},handleDragEnd:function(e,t,a,n){console.log("tree drag end: ",t&&t.label,a)},handleDrop:function(e,t,a,n){console.log("tree drop: ",t.label,a)},handleClickNode:function(e){this.listQuery.department_id=e.id,this.deptName=e.name,this.handleSearch()},allowDrop:function(e,t,a){return"二级 3-1"!==t.data.label||"inner"!==a},allowDrag:function(e){return-1===e.data.label.indexOf("三级 3-2-2")},clearDept:function(){this.listQuery.department_id=void 0,this.deptName="全部",this.handleSearch()},handleSearch:function(){this.listQuery.page=1,this.getList()},getList:function(){var e=this;Object(c["e"])(this.listQuery).then((function(t){e.total=t.data.count,e.tableData=t.data.data}))},handleChangeStatus:function(e){var t=this,a=this.multipleSelection.map((function(e){return e.id}));Object(c["g"])({id:a,status:e}).then((function(){t.getList(),t.$message({message:"操作成功",type:"success"})}))}}},x=k,F=(a("4452"),Object(f["a"])(x,n,i,!1,null,null,null));t["default"]=F.exports},"7a9c":function(e,t,a){"use strict";var n={zh:{organization:{menuModules:{field:{folder:"目录",menu:"菜单",nodeType:"节点类型",nodeName:"节点名称",parentNode:"上级节点",icon:"节点图标",sort:"排序号",filepath:"文件路径",router:"节点路由",auth:"权限",updateTime:"更新时间",action:"操作"}},userModules:{field:{user:"用户",name:"姓名",nameEn:"英文名",username:"用户名",email:"邮箱",phone:"联系电话",role:"角色",status:"状态",remark:"备注",nationality:"国籍",deptname:"部门名称",createTime:"创建时间",password:"密码",action:"操作"},label:{department:"部门",select:"选择",transfer:"转移"},status:{publish:"开启",draft:"关闭",all:"全部"}},deptModules:{field:{name:"部门名称",nameEn:"部门英文名称",parent:"上级部门",sort:"排序",action:"操作"}}}},en:{organization:{field:{user:"USER",name:"姓名",username:"用户名",email:"邮箱",phone:"手机号",role:"角色",status:"状态",remark:"备注"},status:{publish:"开启",draft:"关闭",all:"全部"}}}},i="organization";t["a"]={created:function(){this.$i18n.getLocaleMessage("zh")[i]||(this.$i18n.mergeLocaleMessage("en",n.en),this.$i18n.mergeLocaleMessage("zh",n.zh))},methods:{assign:function(e,t){for(var a in e)void 0!==t[a]&&(e[a]=t[a]);return e}}}}}]);